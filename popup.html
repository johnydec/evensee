<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">

    <!-- Top bar -->
    <header>
      <div class="logo">
        <img src="icons/logo.png" alt="kEye" class="logo-img">
      </div>
      <div class="header-right">
        <div class="privacy-pill">
          <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
          <span>Local only</span>
        </div>
        <button id="settingsBtn" class="btn-settings" title="Settings">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
        </button>
      </div>
    </header>

    <!-- Current site -->
    <div id="currentSite" class="current-site">
      <div class="current-site-info">
        <span id="domain" class="site-domain"></span>
        <span id="tabHint" class="site-hint">Current tab</span>
      </div>
      <button id="toggleBtn" class="capture-btn">
        <span id="toggleIcon" class="capture-btn-icon">
          <svg width="10" height="10" viewBox="0 0 24 24" fill="currentColor" stroke="none"><polygon points="6,3 20,12 6,21"/></svg>
        </span>
        <span id="toggleLabel">Capture</span>
      </button>
    </div>

    <!-- Protected site warning -->
    <div id="protectedNotice" class="notice-protected hidden">
      <div class="notice-icon">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
      </div>
      <div class="notice-text">
        <span id="protectedReason" class="notice-reason"></span>
        <span class="notice-hint">Headers will be captured, but may not work with Playwright. Use CDP for full access.</span>
      </div>
    </div>

    <!-- Reload notice (shown briefly after capture click) -->
    <div id="reloadNotice" class="reload-notice hidden">
      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>
      <span>Page will reload. Reopen popup to see results.</span>
    </div>

    <!-- Error -->
    <div id="error" class="error hidden"></div>

    <!-- Capture status -->
    <div id="status" class="status-bar hidden">
      <div class="status-pulse"></div>
      <span>Listening for auth headers...</span>
      <span id="timer" class="status-timer"></span>
    </div>

    <!-- Empty state -->
    <div id="empty" class="empty-state">
      <div class="empty-icon">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
        </svg>
      </div>
      <p class="empty-title">No sessions captured</p>
      <p class="empty-sub">Hit Capture â€” page reloads, then reopen for results</p>
    </div>

    <!-- Site cards -->
    <div id="siteList" class="site-list hidden"></div>

    <!-- Footer actions -->
    <div id="footer" class="footer hidden">
      <button id="copyAllBtn" class="btn-copy-all">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
          <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
        </svg>
        Copy All Sessions
      </button>
      <div class="footer-row">
        <button id="clearBtn" class="btn-text" disabled>Clear all</button>
        <span id="copyNotice" class="copy-toast hidden">Copied</span>
      </div>
    </div>

    <!-- Settings -->
    <div id="settingsPanel" class="settings-panel hidden">
      <div class="settings-row">
        <div class="settings-label">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
          <span>Auto-clear</span>
        </div>
        <div id="clearOptions" class="settings-options">
          <button class="settings-opt" data-value="5">5m</button>
          <button class="settings-opt" data-value="30">30m</button>
          <button class="settings-opt" data-value="60">60m</button>
          <button class="settings-opt" data-value="0">Manual</button>
        </div>
      </div>
      <div class="settings-row">
        <div class="settings-label">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
          <span>Clipboard clear</span>
        </div>
        <div id="clipboardOptions" class="settings-options">
          <button class="settings-opt" data-value="0.5">30s</button>
          <button class="settings-opt" data-value="2">2m</button>
          <button class="settings-opt" data-value="0">Off</button>
        </div>
      </div>
    </div>

    <!-- Privacy footer -->
    <div class="privacy-footer">
      <div class="privacy-item">
        <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        Memory only
      </div>
      <div class="privacy-sep"></div>
      <div class="privacy-item">
        <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
        <span id="privacyClearLabel">Auto-clear 5m</span>
      </div>
      <div class="privacy-sep"></div>
      <div class="privacy-item">
        <svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
        Zero network
      </div>
    </div>

    <!-- Support -->
    <button id="supportBtn" class="support-btn">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>
      Buy me a coffee
    </button>

    <!-- Version -->
    <div class="version-label">v2.2.1</div>

  </div>
  <script src="popup.js"></script>
</body>
</html>
